# ЁЯФД р╕нр╕▒р╕Юр╣Ар╕Фр╕Чр╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕░р╕Ър╕Ър╕бр╕╖р╣Йр╕нр╕нр╕▓р╕лр╕▓р╕гр╣Гр╕лр╕бр╣И

## ЁЯУЛ р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕З

### р╣Ар╕Бр╣Ир╕▓ (р╕нр╕▓р╕лр╕▓р╕гр╕лр╕ер╕▒р╕Б + р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╣Ар╕Др╕╡р╕вр╕З):
- ЁЯНЫ р╕нр╕▓р╕лр╕▓р╕гр╕лр╕ер╕▒р╕Б (2 р╕Др╕░р╣Бр╕Щр╕Щ/р╕гр╕▓р╕вр╕Бр╕▓р╕г)
- ЁЯеЧ р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╣Ар╕Др╕╡р╕вр╕З (1 р╕Др╕░р╣Бр╕Щр╕Щ/р╕гр╕▓р╕вр╕Бр╕▓р╕г)

### р╣Гр╕лр╕бр╣И (р╕гр╕░р╕Ър╕Ър╕бр╕╖р╣Йр╕нр╕нр╕▓р╕лр╕▓р╕г):
- ЁЯМЕ р╕бр╕╖р╣Йр╕нр╣Ар╕Кр╣Йр╕▓ (2 р╕Др╕░р╣Бр╕Щр╕Щ/р╕гр╕▓р╕вр╕Бр╕▓р╕г)
- тШАя╕П р╕бр╕╖р╣Йр╕нр╕Бр╕ер╕▓р╕Зр╕зр╕▒р╕Щ (2 р╕Др╕░р╣Бр╕Щр╕Щ/р╕гр╕▓р╕вр╕Бр╕▓р╕г)  
- ЁЯМЩ р╕бр╕╖р╣Йр╕нр╣Ар╕вр╣Зр╕Щ (2 р╕Др╕░р╣Бр╕Щр╕Щ/р╕гр╕▓р╕вр╕Бр╕▓р╕г)

## ЁЯЫая╕П р╕зр╕┤р╕Шр╕╡р╕нр╕▒р╕Юр╣Ар╕Фр╕Чр╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 1: р╣Ар╕Юр╕┤р╣Ир╕бр╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╣Гр╕лр╕бр╣И
1. р╣Ар╕Ыр╕┤р╕Ф **Supabase Dashboard**
2. р╣Др╕Ыр╕Чр╕╡р╣И **SQL Editor**
3. р╕Др╕▒р╕Фр╕ер╕нр╕Бр╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М `add-meal-columns.sql`
4. р╕зр╕▓р╕Зр╣Бр╕ер╕░р╕Бр╕Ф **Run**

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 2: р╕Чр╕│р╕Др╕зр╕▓р╕бр╕кр╕░р╕нр╕▓р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓
1. р╕Др╕▒р╕Фр╕ер╕нр╕Бр╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М `cleanup-old-data.sql`
2. р╕зр╕▓р╕Зр╣Бр╕ер╕░р╕Бр╕Ф **Run**
3. р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╕Ир╕░р╣Бр╕Ыр╕ер╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓р╣Гр╕лр╣Йр╣Ар╕Ыр╣Зр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Гр╕лр╕бр╣И

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 3: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М
р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╣Гр╕лр╕бр╣Ир╕Цр╕╣р╕Бр╣Ар╕Юр╕┤р╣Ир╕бр╣Бр╕ер╣Йр╕з:
- `total_items` (INTEGER) - р╕Ир╕│р╕Щр╕зр╕Щр╕гр╕▓р╕вр╕Бр╕▓р╕гр╕нр╕▓р╕лр╕▓р╕гр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
- `meal_breakdown` (JSONB) - р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕▓р╕лр╕▓р╕гр╣Бр╕вр╕Бр╕Хр╕▓р╕бр╕бр╕╖р╣Йр╕н

## ЁЯУК р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣И

### р╕Хр╕▓р╕гр╕▓р╕З scoreboard:
```sql
- id: BIGSERIAL PRIMARY KEY
- user_id: TEXT UNIQUE
- user_name: TEXT
- user_image: TEXT
- current_score: BIGINT (р╕Др╕░р╣Бр╕Щр╕Щр╕ер╣Ир╕▓р╕кр╕╕р╕Ф)
- achieved_at: TIMESTAMPTZ
- main_dish_count: INTEGER (р╣Ар╕Бр╣Ир╕▓ - р╕гр╕нр╕Зр╕гр╕▒р╕Ъ backward compatibility)
- side_dish_count: INTEGER (р╣Ар╕Бр╣Ир╕▓ - р╕гр╕нр╕Зр╕гр╕▒р╕Ъ backward compatibility)
- total_items: INTEGER (р╣Гр╕лр╕бр╣И - р╕Ир╕│р╕Щр╕зр╕Щр╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф)
- meal_breakdown: JSONB (р╣Гр╕лр╕бр╣И - р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕вр╕Бр╕Хр╕▓р╕бр╕бр╕╖р╣Йр╕н)
- created_at: TIMESTAMPTZ
- updated_at: TIMESTAMPTZ
```

### р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ъ meal_breakdown (JSON):
```json
{
  "breakfast": {
    "count": 2,
    "items": [
      {"name": "р╕Вр╣Йр╕▓р╕зр╕Ьр╕▒р╕Ф", "amount": 1},
      {"name": "р╣Др╕Вр╣Ир╕Фр╕▓р╕з", "amount": 1}
    ]
  },
  "lunch": {
    "count": 1,
    "items": [
      {"name": "р╕кр╣Йр╕бр╕Хр╕│", "amount": 1}
    ]
  }
}
```

## ЁЯФД Backward Compatibility

р╕гр╕░р╕Ър╕Ър╕вр╕▒р╕Зр╕Др╕Зр╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓:
- р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓р╕Ир╕░р╣Бр╕кр╕Фр╕Зр╣Ар╕Ыр╣Зр╕Щ ЁЯНЫ р╣Бр╕ер╕░ ЁЯеЧ
- р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣Ир╕Ир╕░р╣Бр╕кр╕Фр╕Зр╣Ар╕Ыр╣Зр╕Щ ЁЯМЕ тШАя╕П ЁЯМЩ
- API р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Чр╕▒р╣Йр╕Зр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Ар╕Бр╣Ир╕▓р╣Бр╕ер╕░р╣Гр╕лр╕бр╣И

## тЬЕ р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ

р╕лр╕ер╕▒р╕Зр╕гр╕▒р╕Щ SQL р╕Чр╕▒р╣Йр╕Зр╕кр╕нр╕Зр╣Др╕Яр╕ер╣Мр╣Бр╕ер╣Йр╕з:
1. р╕ер╕нр╕Зр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Др╕░р╣Бр╕Щр╕Щр╣Гр╕лр╕бр╣Ир╕Фр╣Йр╕зр╕вр╕гр╕░р╕Ър╕Ър╕бр╕╖р╣Йр╕нр╕нр╕▓р╕лр╕▓р╕г
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕лр╕Щр╣Йр╕▓ Scoreboard р╕зр╣Ир╕▓р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓р╕Цр╕╣р╕Бр╣Бр╕Ыр╕ер╕Зр╣Ар╕Ыр╣Зр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Гр╕лр╕бр╣Ир╣Бр╕ер╣Йр╕з
4. **р╣Др╕бр╣Ир╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щ "ЁЯНЫ 0 | ЁЯеЧ 0" р╕нр╕╡р╕Бр╕Хр╣Ир╕нр╣Др╕Ы**

## ЁЯЪи р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕р╕кр╕│р╕Др╕▒р╕Н

- **р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓р╕Ир╕░р╣Др╕бр╣Ир╕кр╕╣р╕Нр╕лр╕▓р╕в** - р╕вр╕▒р╕Зр╕Др╕Зр╣Бр╕кр╕Фр╕Зр╣Др╕Фр╣Йр╕Ыр╕Бр╕Хр╕┤
- **р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕ер╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Фр╕┤р╕б** - р╕гр╕░р╕Ър╕Ър╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Чр╕▒р╣Йр╕Зр╕кр╕нр╕Зр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ъ
- **Real-time р╕вр╕▒р╕Зр╕Др╕Зр╕Чр╕│р╕Зр╕▓р╕Щ** - р╣Др╕бр╣Ир╕бр╕╡р╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ър╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕нр╕▒р╕Юр╣Ар╕Фр╕Чр╣Бр╕Ър╕Ъ real-time

## ЁЯОп р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Чр╕╡р╣Ир╕Др╕▓р╕Фр╕лр╕зр╕▒р╕З

р╕лр╕ер╕▒р╕Зр╕нр╕▒р╕Юр╣Ар╕Фр╕Ч:
- тЬЕ **Scoreboard р╕Ир╕░р╣Др╕бр╣Ир╣Бр╕кр╕Фр╕З "ЁЯНЫ 0 | ЁЯеЧ 0" р╕нр╕╡р╕Бр╕Хр╣Ир╕нр╣Др╕Ы**
- тЬЕ р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕бр╕╖р╣Йр╕нр╕нр╕▓р╕лр╕▓р╕гр╣Бр╕Чр╕Щ р╣Ар╕Кр╣Ир╕Щ "ЁЯМЕ 2 тШАя╕П 1"
- тЬЕ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓р╕Цр╕╣р╕Бр╣Бр╕Ыр╕ер╕Зр╣Ар╕Ыр╣Зр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Гр╕лр╕бр╣Ир╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
- тЬЕ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щ 0 р╕Ир╕░р╣Бр╕кр╕Фр╕З "р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕▓р╕лр╕▓р╕г" р╣Бр╕Чр╕Щ
- тЬЕ UI р╕кр╕зр╕вр╣Бр╕ер╕░р╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╕Зр╣Ир╕▓р╕вр╕Вр╕╢р╣Йр╕Щ

## ЁЯФз р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓ "ЁЯНЫ 0 | ЁЯеЧ 0"

### р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Йр╣Др╕В 3 р╣Бр╕Ър╕Ъ:

1. **р╣Бр╕Ър╕Ър╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤** (р╣Бр╕Щр╕░р╕Щр╕│): р╕гр╕▒р╕Щ `cleanup-old-data.sql` р╣Ар╕Юр╕╖р╣Ир╕нр╣Бр╕Ыр╕ер╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
2. **р╣Бр╕Ър╕Ър╕Лр╣Ир╕нр╕Щ**: р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щ 0 р╕Ир╕░р╣Бр╕кр╕Фр╕З "р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕▓р╕лр╕▓р╕г" р╣Бр╕Чр╕Щ
3. **р╣Бр╕Ър╕Ър╕ер╕Ъ**: р╕ер╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕░р╣Бр╕Щр╕Щ 0 р╕нр╕нр╕Б (р╣Др╕бр╣Ир╣Бр╕Щр╕░р╕Щр╕│)

### р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕лр╕ер╕▒р╕Зр╣Бр╕Бр╣Йр╣Др╕В:

**р╣Ар╕Бр╣Ир╕▓ (р╕Щр╣Ир╕▓р╣Ар╕Бр╕ер╕╡р╕вр╕Ф):**
```
ЁЯНЫ 0 | ЁЯеЧ 0
```

**р╣Гр╕лр╕бр╣И (р╕кр╕зр╕в):**
```
ЁЯМЕ 2  тШАя╕П 1  ЁЯМЩ 3
р╕лр╕гр╕╖р╕н
р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕▓р╕лр╕▓р╕г
```
