# ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Supabase ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Food Score Calculator

## üöÄ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Supabase

### 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Supabase Project
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://supabase.com
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
3. ‡∏Ñ‡∏•‡∏¥‡∏Å "New Project"
4. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Organization ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ project ‡πÄ‡∏ä‡πà‡∏ô "food-score-calculator"
5. ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô database
6. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å region ‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
7. ‡∏Ñ‡∏•‡∏¥‡∏Å "Create new project"

### 2. ‡∏£‡∏±‡∏ô SQL Script
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Supabase Dashboard ‚Üí SQL Editor
2. ‡∏Ñ‡∏•‡∏¥‡∏Å "New query"
3. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå `supabase-setup.sql`
4. ‡∏ß‡∏≤‡∏á‡∏•‡∏á‡πÉ‡∏ô SQL Editor
5. ‡∏Ñ‡∏•‡∏¥‡∏Å "Run" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á table ‡πÅ‡∏•‡∏∞ functions

### 3. ‡∏î‡∏∂‡∏á API Keys
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Settings ‚Üí API
2. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å:
   - **Project URL** (‡πÉ‡∏ô Project URL)
   - **anon public** key (‡πÉ‡∏ô Project API keys)

### 4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables

#### Local Development (.env.local):
```env
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
```

#### Vercel Production:
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Vercel Dashboard ‚Üí Project Settings ‚Üí Environment Variables
2. ‡πÄ‡∏û‡∏¥‡πà‡∏°:
   - `NEXT_PUBLIC_SUPABASE_URL` = `https://your-project-id.supabase.co`
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY` = `your-anon-key`

### 5. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Row Level Security (RLS)
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Table Editor ‚Üí scoreboard table
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ RLS ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Policies:
   - "Anyone can read scoreboard" (SELECT)
   - "Users can insert their own scores" (INSERT)
   - "Users can update their own scores" (UPDATE)

### 6. ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Realtime
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Database ‚Üí Replication
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ table `scoreboard` ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô Realtime publications
3. ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á:
   ```sql
   ALTER PUBLICATION supabase_realtime ADD TABLE public.scoreboard;
   ```

## üîß ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠:
1. ‡∏£‡∏±‡∏ô‡πÅ‡∏≠‡∏õ: `npm run dev`
2. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà `/scoreboard`
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö console ‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ error
4. ‡∏•‡∏≠‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô Supabase Dashboard

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Real-time:
1. ‡πÄ‡∏õ‡∏¥‡∏î 2 browser tabs
2. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÉ‡∏ô tab ‡∏´‡∏ô‡∏∂‡πà‡∏á
3. ‡∏î‡∏π tab ‡∏≠‡∏∑‡πà‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏ö‡∏ö real-time

## üìä Database Schema

### Table: scoreboard
```sql
- id: BIGSERIAL PRIMARY KEY
- user_id: TEXT UNIQUE (Discord user ID)
- user_name: TEXT (Discord username)
- user_image: TEXT (Discord avatar URL)
- highest_score: INTEGER (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î)
- achieved_at: TIMESTAMPTZ (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥)
- main_dish_count: INTEGER (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å)
- side_dish_count: INTEGER (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á)
- created_at: TIMESTAMPTZ
- updated_at: TIMESTAMPTZ
```

## üîí Security Features

- **Row Level Security (RLS)**: ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï
- **API Keys**: ‡πÉ‡∏ä‡πâ anon key ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö public access
- **Policies**: ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô/‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

## üö® ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

1. **API Keys**: ‡πÄ‡∏Å‡πá‡∏ö anon key ‡πÉ‡∏´‡πâ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÅ‡∏°‡πâ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô public key
2. **RLS**: ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô RLS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
3. **Realtime**: ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° table ‡πÉ‡∏ô realtime publication
4. **Fallback**: ‡πÅ‡∏≠‡∏õ‡∏à‡∏∞‡πÉ‡∏ä‡πâ in-memory storage ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ Supabase

## üîÑ Migration ‡∏à‡∏≤‡∏Å MongoDB

‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô MongoDB:
1. Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å MongoDB
2. ‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Supabase schema
3. Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡πà‡∏≤‡∏ô Supabase Dashboard ‡∏´‡∏£‡∏∑‡∏≠ SQL

## üìû ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠

‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Supabase Dashboard ‚Üí Logs
2. ‡∏î‡∏π browser console ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö error messages
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö environment variables
4. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢ SQL Editor
